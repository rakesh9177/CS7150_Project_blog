<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>An Analysis of AWQ: Activation-aware Weight Quantization for LLM Compression and Acceleration</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="eb968c29-4c3d-4475-8f72-1eb450ad8ebd" class="page sans"><header><h1 class="page-title">An Analysis of <strong>AWQ: Activation-aware Weight Quantization for LLM Compression and Acceleration</strong></h1><p class="page-description"></p></header><div class="page-body"><p id="08e73755-9dd5-4e0e-9eb3-b4ded878da36" class="">                                                                                 - <strong><em>by Luv Verma, Rakesh Rathod (</em></strong><a href="https://rakesh9177-quantization.hf.space"><strong><em>Hugging Face</em></strong></a><strong><em>)</em></strong></p><p id="db12592f-963b-4786-9ef3-32033a0bc1d4" class="">
</p><h1 id="80b0eede-f3c8-4136-a503-07a706e12167" class="">Introduction</h1><p id="71a14348-eb21-41fe-ad16-036b5bcacf87" class="">
</p><p id="5fceec98-3713-419a-a823-36021eae7461" class="">Large Language Models (LLMs) based on transformers[1] have taken the world by storm. ChatGPT is one such example. However, with advantages comes the astronomical cost for hardware. For example, GPT-3 has 175B parameters which is 350GB in FP16, while the latest H100 GPU only has 96GB memory, let alone edge devices. Large Language Models, such as GPT-3 (Generative Pre-trained Transformer 3), often have millions or even billions of parameters, and these parameters are typically represented using high-precision floating-point numbers. Quantization solves this problem to an extent. Quantization refers to the process of reducing the precision of the numerical values used to represent the model&#x27;s parameters and activations. Quantization aims to make the model more efficient for deployment on resource-constrained devices by reducing the bit-width or precision of these numerical values. Instead of using 32-bit floating-point numbers, quantization may involve representing them using 16-bit fixed-point or even lower-precision integer formats. This results in a reduction in memory requirements, allowing for more compact model storage and faster inference. Hence, this blog has taken a recently developed method called Activation-aware weight quantization [2]. </p><h1 id="1e20a655-b8ef-4470-bfcb-fb1cc788fd63" class=""><strong>Historical Background</strong></h1><p id="da5d534d-988a-48c9-86c4-f93dc2a70dcd" class="">
</p><p id="f132eebc-8b58-4b24-b213-5d8928d553ff" class="">In the early days of telecommunications during the 19th century, engineers grappled with the formidable challenge of transmitting analog signals over vast distances. The inherent infinite resolution of continuous analog signals posed a dilemma. Enter Harry Nyquist, an American engineer, who, in the early 20th century, formulated the Nyquist-Shannon sampling theorem. This groundbreaking idea, later popularized by Claude Shannon, asserted that to accurately reconstruct a continuous signal, the sampling rate must be at least twice the signal&#x27;s maximum frequency. This theoretical revelation set the stage for practical implementation by Alec H. Reeves in the 1930s—the Pulse Code Modulation (PCM). PCM involves the systematic quantization of analog signals through regular sampling and discretization. With the advent of digital computers, Digital Signal Processing (DSP) techniques emerged, ushering in a new era of applying quantization to a broader range of signal-processing tasks. Claude Shannon&#x27;s information theory further deepened the understanding of quantization&#x27;s role in balancing information compression and loss. As technology progressed, quantization became a linchpin in compression methods for efficient data storage and transmission. Today, in the realm of machine learning, quantization continues to evolve, optimizing the deployment of large neural networks on resource-constrained devices. The story of quantization unfolds as a journey from the early challenges of telecommunications to a fundamental concept shaping the digital landscape.</p><p id="02e5e72a-2fdb-41ab-88b8-3d6042326e4b" class="">As the demand for more sophisticated machine learning models grew, the limitations of hardware became evident, especially when dealing with large-scale models like GPT-3. With billions of parameters, these models strain memory and computational resources, making deployment on edge devices a formidable task.</p><p id="1507ecde-0b5c-40d6-b110-ec6859175487" class="">In response to these challenges, researchers and practitioners sought ways to optimize the quantization process further. Traditional quantization techniques were effective but lacked a nuanced understanding of the dynamic nature of activations within the neural network during inference.</p><p id="fc66aa1f-aebc-4aec-8e8d-2adf5592f754" class="">Enter Activation-Aware Weight Quantization. This method represents a paradigm shift in the quantization landscape by introducing a heightened awareness of activation patterns. Instead of uniformly treating weights and activations, AAWQ takes into account the specific characteristics of the data flow during inference.</p><h1 id="311b2933-b970-4998-bab2-456bff8210ec" class="">Literature Review</h1><p id="038c25ab-6ca7-4a5f-9eb4-a2f832c29826" class="">
</p><ol type="1" id="ee0ada95-8721-416a-a3cd-81c475c77c37" class="numbered-list" start="1"><li><strong>Deep Compression [3]</strong>: Quantization reduces the bit-precision of deep learning models, which helps to reduce the model size and accelerate inference</li></ol><ol type="1" id="df4d6ce6-c691-4585-9cd5-1f60d2930b79" class="numbered-list" start="2"><li><strong>Post-Training Quantization (PTQ) [4, 5]</strong>: It quantizes the weights and activations of the model without necessitating any retraining. It fuses activations into preceding layers wherever possible and requires calibration with a representative dataset to determine optimal quantization parameters for activations. This is used when both memory bandwidth and compute savings are important with CNNs being the typical use case. However, in a low-bit setting, PTQ suffers from large accuracy degradation. </li></ol><ol type="1" id="c3a525e8-a158-4519-b075-a8761b233265" class="numbered-list" start="3"><li><strong>Quantization Aware Training (QAT) [6]:</strong> QAT inserts fake quantization to all the weights and activations during the model training process and results in higher inference accuracy than PTQ methods. This is typically used for CNNs, however, the training cost is higher and also needs training data. </li></ol><ol type="1" id="dd18c510-6a1f-4400-9572-8e64a3db5ff0" class="numbered-list" start="4"><li><strong>Generative Pre-trained Transformer Quantization (GPTQ) [7]:</strong> Published in 2023 at ICLR, GPTQ uses a second-order information to perform error compensation. However, it overfits the calibration set during reconstruction, distorting the learned features on out-of-distribution domains, which could be problematic since LLMs are generalist models. </li></ol><ol type="1" id="1648af18-adce-47a4-a38e-8dc2f1230994" class="numbered-list" start="5"><li><strong>4 bits Quantization for LLM Inference [8]: </strong>Published in 2023 in ICML, the researchers showed that using 4-bit quantization for LLM inference yield optimal performance for a fixed number of model bits across all model scales and model families instead.</li></ol><ol type="1" id="564e7aae-b43d-4f09-963a-0cb545115325" class="numbered-list" start="6"><li><strong>LLM.int8()[9]: </strong>Published in 2022, researchers developed a methodology to load a 175B parameter transformer with 16 or 32-bit weights, convert the feed-forward and attention projection layers to 8-bit, and use the resulting model immediately for inference without any performance degradation. To do this, they solved two key challenges, which were the need for higher quantization precision at scales beyond 1B parameters and need to expicitle represent teh sparse but systematic large magnitude outlier features. </li></ol><ol type="1" id="2f34551c-7e02-4683-b277-2301c4b6ae67" class="numbered-list" start="7"><li><strong>Weight Magnitudes for Quantization [10]: </strong>In 2015, researchers observed that the most important weight channels are determined by looking at the magnitudes of the weight channels or their <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span>-Norm, however the current research didn’t find it to be helpful in quantization procedure. </li></ol><ol type="1" id="921830ff-24c4-40f5-b92e-8b48072d487e" class="numbered-list" start="8"><li><strong>W8A8 Quantization[11]</strong>:  Both activation and weights are quantized to INT8. Industrial standard for CNNs. However, it has been observed that W8A8 quantization does not work as the number of parameters increases (for LLMs). The reason behind this is that systematic outliers emerge in activations when LLMs are scaled up beyond 6.7 billion parameters. </li></ol><ol type="1" id="ad8c15d8-daf2-4040-a498-056bcf444ee0" class="numbered-list" start="9"><li><strong>W4A16 Quantization[12]</strong>: This is low-bit weight-only quantiation, where only weights are quantizated into low-bit integers. It;s shown that this setting leads to the higher throughput during the inference. Specifically, W4A16 leads to efficeint offloading strategy for the higher throughput generative inference on a single commodity. One of the ways is to offload to a secondary storage and perform computation part-by-part by partial loading. W4A16 settings overcome such structure. Therefore, in the current research W4A16 structure is explored</li></ol><h1 id="5fe812f6-0725-4eb6-bdf9-dbb9f9d1b3c2" class=""><strong>Paper Authors</strong> </h1><p id="9d168da0-6555-47e1-8d64-ea31494687fe" class="">
</p><figure id="42b524bc-d1f6-4306-b649-7baa34cb315e" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled.png"><img style="width:1914px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled.png"/></a></figure><p id="ff6bfc68-8a4c-4c48-8788-07bdf7691be9" class=""><strong>Song Han </strong>is an associate professor at MIT EECS. He received his PhD degree from Stanford University. He proposed the “Deep Compression” technique including pruning and quantization that is widely used for efficient AI computing, and “Efficient Inference Engine” that first brought weight sparsity to modern AI chips, which influenced NVIDIA’s Ampere GPU Architecture with Sparse Tensor Core. He pioneered the TinyML research that brings deep learning to IoT devices, enabling learning on the edge. He has been cited 50392 times.</p><p id="1de14151-c7c8-45dc-ab67-f8e2ecf9bfd4" class=""><strong>Chuang Gan</strong> is a faculty member at UMass Amherst and a research manager at MIT-IBM Watson AI Lab. I was a postdoc at MIT, working with Prof. Antonio Torralba, Prof. Daniela Rus, and Prof. Josh Tenenbaum.  He has been cited 15131 times.</p><p id="3ebea4ce-f93f-4c40-861a-3f07752c1bcf" class=""><strong>Ji Lin</strong> is a Final-year Ph.D. student at MIT EECS, advised by Prof. Song Han and a Member of Technical Staff at OpenAI. He has been cited 8070 times. </p><p id="6c19d7b2-38b2-47fc-aa08-831e668bc7a8" class=""><strong>Haitian Tang</strong> is a third year PhD student at Han Lab of MIT EECS.  He has been cited 1614 times. </p><p id="ec08c836-8f05-4e60-8c1d-a14a3ae6d42a" class=""><strong>Shang Yang</strong> is a First year PhD student at MIT Han Lab</p><p id="0fc66d27-2d71-4c15-a5ae-637418e3258b" class=""><strong>Xingyu Dang</strong> is a Undergraduate Research assistant at MIT Han Lab. </p><p id="6df0edda-c764-4098-b9ec-72d03a2ec81f" class=""><strong>Jiaming Tang</strong> is a Research Intern at MIT Han Lab.</p><h1 id="28723f40-56de-4385-9070-e534112531e1" class="">Challenges with LLMs Inferencing</h1><h2 id="c13bbe0d-1a30-45fa-8360-c03ea8f24df5" class="">Post Training Quantization Method: SmoothQuant</h2><p id="8156e9d3-76ef-4900-8113-5c2fe300c240" class="">The QAT methods cannot easily scale up to large models like LLMs. Therefore, people usually use PTQ methods to quantize LLMs.</p><h3 id="9eb05112-a2d0-4855-9436-3772210f49e7" class="">Two settings for LLM Quantization [2]</h3><ol type="1" id="1f1e6212-c754-476f-a091-6595fe9ca011" class="numbered-list" start="1"><li><strong>W8A8 Quantization:</strong> Both activation and weights are quantized to INT8. Industrial standard for CNNs.</li></ol><ol type="1" id="ceb8cad4-5631-4476-ad57-4a7708829c9a" class="numbered-list" start="2"><li><strong>W4A16 Quantization:</strong> Weights are quantized to INT4. This setting leads to a reduction in hardware barrier (requiring a smaller memory size) and also speeds up the token generation (remedying memory-bound workload)</li></ol><figure id="9b3c8d58-bc3e-4db1-b056-edcd88d8c343" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%201.png"><img style="width:420px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%201.png"/></a></figure><p id="32a2402a-3c0f-4f7d-b5ae-3b44f621945f" class=""><strong>Figure 2 [13]: Accuracy degradation with W8A8 quantization with an increase in the number of parameters</strong></p><p id="f5aa0710-dc06-41b6-bc17-33c6f49510d8" class="">
</p><p id="ff814037-4b8b-4620-8dac-91594010b158" class="">From Figure 2, it has been observed that W8A8 quantization does not work as the number of parameters increases. The reason behind this is that systematic outliers emerge in activations when LLMs are scaled up beyond 6.7 billion parameters. </p><figure id="66084f3f-45fe-4f42-8db8-941f91865139" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%202.png"><img style="width:666px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%202.png"/></a></figure><p id="7a796708-e056-4a8c-ad44-67fb46547d7a" class=""><strong>Figure 3 [13]: shows the systematic outliers happening in LLM (OPT-13B).</strong></p><p id="1b3c7d83-8d7d-48a5-b053-a92f85d7ecf0" class="">
</p><p id="c4de6aac-780c-4ad3-b02c-7cdec7ba45aa" class="">In Figure 3, it can be seen that certain channels have much higher activation values (magnitudes, greater than 70), however, the weight distribution is flat and uniform (between 0 and 1). Such higher dynamic ranges for activation make it difficult to quantize activations, however, weights are very easy to quantize. </p><figure id="9bdf812e-585b-42d3-8da0-5eefe84d73e6" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%203.png"><img style="width:1808px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%203.png"/></a></figure><p id="5db746ae-90e8-4be6-ae1d-7c8b29c7d246" class=""><strong>Figure 4 [13]: (a): Scaling down activations and scaling up the weights, (b): Scaling factor and output calculations</strong></p><p id="db5b9ab2-22ec-41b8-85fc-2c5bd8807645" class="">Figure 4, shows how the smoothQuant technique deals with it. It scales down the activation, and scales by the weight so that the overall effect cancels out, which now makes activations easier to quantize. The scaling parameter now reduces the range of activations, which makes them easier to quantize in comparison to the Figure 3 range. Weight values are slightly increased (for the same channels), but still, weights can also be quantized. </p><figure id="257e1f08-6ebc-44bd-91aa-18d9c991b939" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%204.png"><img style="width:608px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%204.png"/></a></figure><p id="f6dddcc6-612e-450a-9fdb-ab4070e51ae2" class=""><strong>Figure 5 [13]: Green Layers (INT 8) quantized, yellow layers (FP16). All compute-intensive operators quantized </strong></p><p id="7f7ffac6-6b4f-4150-ac86-07a97502b963" class="">
</p><p id="57d621e2-0faf-4d16-980d-fe99d0ef9d49" class="">Figure 5 shows which were the layers quantized using SmoothQuant (W8A8)</p><figure id="5ada77b8-e076-4b8e-83ef-0c7473e49663" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%205.png"><img style="width:1288px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%205.png"/></a></figure><p id="8a43caa6-ae21-45b0-adfb-ca6d6099e634" class=""><strong>Figure 6 (a): Latency, (b): Memory footprint for OPT-175B</strong></p><p id="8d243437-3c1d-4c6f-b046-fba9c0953aff" class="">Figure 6, shows that the method worked well in terms of maintaining accuracy without fine-tuning, accelerated inference, and reduced the memory footprints to half for the OPT-175B model. For the MT-NLG 530B model, it was observed that it reduced the no of GPUs from 16 (for FP16) to 8 (for INT8) at a similar latency. </p><h3 id="105adb77-4f5f-4752-a957-17ad0c1d90a7" class="">Memory Bound Challenges</h3><figure id="d4c4a143-f2a4-40b5-ac25-dd242ac3d9fc" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%206.png"><img style="width:1634px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%206.png"/></a></figure><p id="32cf181d-269b-4be6-a3d8-f1c0e2006d85" class=""><strong>Figure 7 (a): Roofline Model  (Performance (GFLOPs/sec) vs Operational Intensity (Flops/byte)), (b): Example showing the downside of SmoothQuant method for single-query (batch size = 1) LLM inference over A100 GPU, LLaMA-65B model (highly memory bounded) [16]</strong></p><p id="eb385216-703e-46bf-b746-46f8314167f4" class="">
</p><p id="3bd9c435-31e1-4fcf-9c49-13f31dde16bd" class="">According to Figure 7 (b), the technique works well for the batch serving (tested on a batch size of 128, LLaMA-65B model), however for a single-query LLM Inference, the method is still memory-bounded. According to Figure 7 (b), it is memory-bounded, because if there are 65 billion parameters, at fp16, for a single query inference (generating a single token), it requires access to 130 GB of memory. </p><p id="1e420515-b62b-4118-98c9-fd2c99a2ef55" class=""><strong>To put things in perspective, for A100 GPU:</strong></p><ol type="1" id="2aebe869-692e-4a19-be8c-eff3d390fb3a" class="numbered-list" start="1"><li>There are 108 Streaming multiprocessors (SMs)</li></ol><ol type="1" id="ea890477-dc00-4a35-b101-7ba24af3f8ee" class="numbered-list" start="2"><li>Each SM can request 64 bytes of memory per clock cycle.</li></ol><ol type="1" id="48d862ba-6893-46fb-a5d4-a4b8db1d33b3" class="numbered-list" start="3"><li>Each SM can run at 1410 MHz.</li></ol><ol type="1" id="0267704b-7983-44ce-8dc3-2cad77d97831" class="numbered-list" start="4"><li>Therefore, in 1 second, the peak memory request can be: 64 bytes * 108 SMs * 1410 MHz = 9750 GB/sec. </li></ol><ol type="1" id="88e271ef-cadc-4cd8-a55e-b256afcb6582" class="numbered-list" start="5"><li>A100 has a memory bandwidth of 1555 Gb/sec, which means that data request is 6.7x times the memory bandwidth. </li></ol><ol type="1" id="f8fc2a11-83e3-49dc-bf57-fa1dcd7e428a" class="numbered-list" start="6"><li><strong>SmoothQuant is Memory Bounded for inference of batch size of 1:</strong> In scenarios, where data is not accessed with peak memory request, the number of accesses increases. Such is a scenario for single-size batch inference. Therefore, it’s shown in Figure 7 (b), that the smaller the batch size, the higher is the memory bound (Figure 7(a))</li></ol><h1 id="6a5c2fe2-1538-4ea7-bb30-6765e70653d4" class="">Core Idea/Methodology</h1><h2 id="221e93a0-3efb-4632-9c5e-87be918443ab" class="">PTQ Method 2 for LLMs: Activation-aware Weight Quantization (AWQ)</h2><p id="95181a6b-fd39-4321-b923-19a42d34fe36" class="">
</p><figure id="ad41e8b9-d1e8-42d7-b0e5-8ee8a495b366" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%207.png"><img style="width:1402px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%207.png"/></a></figure><p id="d1e9e472-51a1-4a64-932e-51b89475c792" class=""><strong>Figure 8: (a): changing weights from FP16 to INT3. (b): Perplexity degraded on OPT-6.7B Wiki-2</strong></p><p id="d2808e95-838a-4825-b10e-544e03b257e8" class="">In AWQ [2], weights are quantized to INT4 or INT3. Activations are left at FP16. This is because, for a single batch, activations would be much smaller (vector) in comparison to the weights (matrix), and thus it makes sense to quantize weights. Quantizing weights leads to a reduction in the memory requirements and accelerates the token generation process. For example, if for 7 billion prameters, if we want to fetch the weights saved at FP16, that would be 7 billion * 2 bytes (2 bytes for FP16) = 14 GB of memory. However, at INT4 this will reduce to only 3.5 GB (INT4 is 0.5 bytes). However, by reducing all weights to INT4 it was observed that the perplexity score went up (Figure 8(a &amp; b), the lower the better). </p><p id="7fa1dd61-f168-4cde-8e41-00f6f7613784" class="">
</p><figure id="04de5afb-b683-4b1d-8789-26bfceaccfc6" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%208.png"><img style="width:1408px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%208.png"/></a></figure><p id="45a5dc62-4871-42f4-897c-f23d620b2298" class=""><strong>Figure 9: (a): Mixed precision weights (1% salient weights kept at FP16), (b): Preplexity reduced again after mixed precision. </strong></p><h3 id="9ff3ff4a-39ab-4896-94cf-3bf65cc85419" class=""><strong>How to Select Salient Weights? </strong></h3><p id="cdc3327b-0488-4d37-99a5-5e8366ee8831" class="">The authors came up with an idea of mixed-precision quantization of weights, where only 1% of the weights were kept at FP16 and the rest were reduced to either INT4 or INT3. The 1% weights, which were kept at FP16 were the salient/most important weights. The saliency was determined based on the value of activations. For example, in the outlier channels (where the activations were outlier), the weight of the corresponding channel was important and should be included in 1% and that is called activation aware weight quantization in the paper. This led to an instant reduction on the perplexity as shown in Figure 9 (a &amp; b). Therefore, the authors looked for the activation distribution, for selecting 1% of salient weight values. </p><h3 id="97658e93-944b-4da4-8b43-97d9e7ad9fbc" class=""><strong>Can we get rid of mixed-precision? </strong></h3><p id="37e5364f-221c-4a0d-b948-5dcc21013fda" class="">Mixed precision is not hardware efficient, as it makes the system implementation difficult. Therefore, the requirement was to protect the important weights without actually keeping them as FP16 (Figure 9b). </p><figure id="fba2c625-0e6e-47dc-b63c-7ff2934f7c3e" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%209.png"><img style="width:1069px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%209.png"/></a></figure><p id="45dbe2b6-467a-48b7-9749-5a281feda675" class=""><strong>Figure 9b: (a): Multiplied the salient channels with s &gt; 1 to reduce the quantization error (b): Preplexity reduced.</strong></p><p id="d8607b7e-c308-41b1-813a-46570791144e" class="">Protecting Salient Weights by Activation-aware Scaling (<strong>Figure 9b</strong>):</p><ol type="1" id="3dccb70c-9c2c-4893-b0d3-40d559622e7d" class="numbered-list" start="1"><li>Consider a linear operator: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mi mathvariant="bold">w</mi><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{y}=\mathbf{w}\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf">wx</span></span></span></span></span><span>﻿</span></span></li></ol><ol type="1" id="1bf45df4-cb7b-42e4-94ac-0cea2d53265a" class="numbered-list" start="2"><li>Its quantized counterpart is: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">y</mi><mo>=</mo><mi>Q</mi><mo stretchy="false">(</mo><mi mathvariant="bold">w</mi><mo stretchy="false">)</mo><mi mathvariant="bold">x</mi></mrow><annotation encoding="application/x-tex">\mathbf{y} = Q(\mathbf{w})\mathbf{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">w</span><span class="mclose">)</span><span class="mord mathbf">x</span></span></span></span></span><span>﻿</span></span></li></ol><ol type="1" id="a2f44667-aee9-4687-906d-2d77e31c630b" class="numbered-list" start="3"><li>The quantization <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi mathvariant="bold">w</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(\mathbf{w})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">w</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span> is given as: </li></ol><figure id="375b4859-9e72-4fd2-b5e0-aec5889cd64e" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi mathvariant="bold">w</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="normal">Δ</mi><mi mathvariant="normal">.</mi><mi>R</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>d</mi><mo stretchy="false">(</mo><mfrac><mi mathvariant="bold">w</mi><mi mathvariant="normal">Δ</mi></mfrac><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{split}
Q(\mathbf{w}) &amp; =   \Delta.Round(\frac{\mathbf{w}}{\Delta})\\                       
\end{split}
\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.1074em;vertical-align:-0.8037em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3037em;"><span style="top:-3.3037em;"><span class="pstrut" style="height:3.3037em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3037em;"><span style="top:-3.3037em;"><span class="pstrut" style="height:3.1214em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">w</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8037em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3037em;"><span style="top:-3.3037em;"><span class="pstrut" style="height:3.1214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">Δ.</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8037em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8037em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3037em;"><span style="top:-3.3037em;"><span class="pstrut" style="height:3.3037em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8037em;"><span></span></span></span></span></span></span></span></span></div></figure><p id="6b332590-ac54-437c-add2-353ebef60e7a" class="">where </p><figure id="8dc0471e-9093-49e7-8262-36df8bb949d2" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">Δ</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi mathvariant="bold">w</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><msup><mn>2</mn><mrow><mi>N</mi><mo>−</mo><mn>1</mn></mrow></msup></mfrac></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{split}
\Delta &amp; =   \frac{\max(|\mathbf{w}|)}{2^{N-1}}\\                       
\end{split}
\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.413em;vertical-align:-0.9565em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4565em;"><span style="top:-3.4565em;"><span class="pstrut" style="height:3.4565em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4565em;"><span style="top:-3.4565em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord">Δ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9565em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4565em;"><span style="top:-3.4565em;"><span class="pstrut" style="height:3.427em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7673em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathbf" style="margin-right:0.01597em;">w</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9565em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9565em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4565em;"><span style="top:-3.4565em;"><span class="pstrut" style="height:3.4565em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9565em;"><span></span></span></span></span></span></span></span></span></div></figure><p id="05743d9a-423c-415f-ad65-163ea748d5c8" class="">From equations 1, and 2, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span><span>﻿</span></span> is the number of quantization bits, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Δ</mi></mrow><annotation encoding="application/x-tex">\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span></span><span>﻿</span></span> is the quantization scaler determined by the absolute maximum value. Now consider a weight element <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>∈</mo><mi mathvariant="bold">w</mi></mrow><annotation encoding="application/x-tex">w \in \mathbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span></span></span></span><span>﻿</span></span>. In equation 1, multiply <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">w</mi></mrow><annotation encoding="application/x-tex">\mathbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span></span></span></span><span>﻿</span></span> with <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span> and the inversely scale x, we will have:</p><figure id="c7363b7f-4f8d-419d-b8d8-37fcb7b40604" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi>w</mi><mi mathvariant="normal">.</mi><mi>s</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi><mfrac><mi>x</mi><mi>s</mi></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msup><mi mathvariant="normal">Δ</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mi mathvariant="normal">.</mi><mi>R</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>d</mi><mo stretchy="false">(</mo><mfrac><mrow><mi>w</mi><mi>s</mi></mrow><mi mathvariant="normal">Δ</mi></mfrac><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi><mi>x</mi><mi mathvariant="normal">.</mi><mfrac><mn>1</mn><mi>s</mi></mfrac></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{split}
Q(w.s).\frac{x}{s} &amp; =   \Delta^{&#x27;}.Round(\frac{ws}{\Delta}).x.\frac{1}{s}\\                       
\end{split}
\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.9037em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4037em;"><span style="top:-3.4037em;"><span class="pstrut" style="height:3.4037em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4037em;"><span style="top:-3.4037em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord">.</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mord">.</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9037em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4037em;"><span style="top:-3.4037em;"><span class="pstrut" style="height:3.3214em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9925em;"><span style="top:-2.9925em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1076em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">Δ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord">.</span><span class="mord mathnormal">x</span><span class="mord">.</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9037em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9037em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4037em;"><span style="top:-3.4037em;"><span class="pstrut" style="height:3.4037em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9037em;"><span></span></span></span></span></span></span></span></span></div></figure><p id="9e26da3a-d029-4a17-8f2c-f6382a3334d3" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">Δ</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup></mrow><annotation encoding="application/x-tex">\Delta^{&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9425em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the new quantization scaler after applying s. Empirically, the authors observed the following:</p><ul id="96772744-5ca0-435a-87ec-78b6bd62bb90" class="bulleted-list"><li style="list-style-type:disc">expected error from Round(.) is always ~0.25 since round error is uniformly distributed from 0-0.5. </li></ul><ul id="92443d18-de20-442c-a8aa-315148a448b8" class="bulleted-list"><li style="list-style-type:disc">Scaling up a single element w usually does not change the extreme value from the group <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">w</mi></mrow><annotation encoding="application/x-tex">\mathbf{w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">w</span></span></span></span></span><span>﻿</span></span>. Therefore <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="normal">Δ</mi><msup><mrow></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></msup><mo>≡</mo><mi mathvariant="normal">Δ</mi></mrow><annotation encoding="application/x-tex">\Delta^{&#x27;} \equiv \Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9425em;"></span><span class="mord"><span class="mord">Δ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-2.9425em;margin-right:0.05em;"><span class="pstrut" style="height:2.5795em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Δ</span></span></span></span></span><span>﻿</span></span> </li></ul><ul id="ff0eb3d6-7bff-4486-b289-7e94f5a7785e" class="bulleted-list"><li style="list-style-type:disc">when <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span><span>﻿</span></span>, the quantization error is scaled down (from Equation 3). </li></ul><ol type="1" id="00b96d72-c9dd-47f0-a7d5-47af53d79f49" class="numbered-list" start="4"><li>From all the points above, it can be derived that if scaling up the most salient weight channel is equivalent of preserving it (as happened in mixed precision, Figure 9). Therefore we can instead of working with <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mi mathvariant="bold">W</mi><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">y =\mathbf{W}\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">WX</span></span></span></span></span><span>﻿</span></span>, we can write, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo stretchy="false">(</mo><mi mathvariant="bold">W</mi><mi mathvariant="normal">.</mi><mi mathvariant="bold">s</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi mathvariant="bold">s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">.</mi><mi mathvariant="bold">X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(\mathbf{W}.\mathbf{s})(\mathbf{s}^{-1}.\mathbf{X})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="mord">.</span><span class="mord mathbf">s</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathbf">X</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span>.</li></ol><ol type="1" id="5226cc13-9a36-4933-ab54-e3462e9bc523" class="numbered-list" start="5"><li>Formally, the objective becomes:</li></ol><figure id="41a5ed4e-e99b-4b64-a2e2-3af30caed5a7" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>s</mi><mo lspace="0em" rspace="0em">∗</mo></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>a</mi><mi>r</mi><mi>g</mi><mtext> </mtext><mi>m</mi><mi>i</mi><mi>n</mi><mtext> </mtext><mi>L</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>Q</mi><mo stretchy="false">(</mo><mi mathvariant="bold">W</mi><mi mathvariant="normal">.</mi><mi mathvariant="bold">s</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msup><mi mathvariant="bold">s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">.</mi><mi mathvariant="bold">X</mi><mo stretchy="false">)</mo><mo>−</mo><mi mathvariant="bold">W</mi><mi mathvariant="bold">X</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{split}
s^{*} &amp;= arg \:min\:  L(s) \\

                        &amp;=  
    ||Q(\mathbf{W}.\mathbf{s})(\mathbf{s}^{-1}.\mathbf{X}) - \mathbf{W}\mathbf{X}||\\
 
\end{split}
\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0241em;vertical-align:-1.2621em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.7621em;"><span class="pstrut" style="height:3.7621em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.9221em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.3979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.9221em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">min</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span><span style="top:-2.3979em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">∣∣</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathbf" style="margin-right:0.01597em;">W</span><span class="mord">.</span><span class="mord mathbf">s</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathbf">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathbf">WX</span><span class="mord">∣∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7621em;"><span style="top:-3.7621em;"><span class="pstrut" style="height:3.7621em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2621em;"><span></span></span></span></span></span></span></span></span></div></figure><ul id="7ed882c5-66a4-432f-a6c0-b568c74ed706" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span></span><span>﻿</span></span> : Weight quantization function (e.g, INT3/INT4 quantization). Not directly differentiable during back prop. </li></ul><ul id="b0f877a5-ce9c-4027-bd65-eb0fdc3d4d4c" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">W</mi></mrow><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf" style="margin-right:0.01597em;">W</span></span></span></span></span><span>﻿</span></span>: Original weights in FP16</li></ul><ul id="4c9659b4-aad7-4963-be66-28dda629f243" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em;"></span><span class="mord mathbf">X</span></span></span></span></span><span>﻿</span></span>: Input features cached from a small calibration set</li></ul><ul id="ce4ff207-5f87-4f10-bada-d4befd310b0e" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">s</span></span></span></span></span><span>﻿</span></span>: Scaling factor</li></ul><ul id="ffa540de-f811-4688-9264-d55c3a1c226b" class="bulleted-list"><li style="list-style-type:disc"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>s</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi mathvariant="normal">.</mi><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">s^{-1}.\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">.</span><span class="mord mathbf">X</span></span></span></span></span><span>﻿</span></span>: to be fused into the previous operator</li></ul><p id="bdaaaf26-eb45-405d-ac79-e9cc3e12d9c7" class="">In equation 4, the optimization objective is to find the scaling factor s that minimizes the difference between the quantized model and the original model’s output. Since the quantization function is non-differentiable, s cannot be optimized by backpropagation, however, a search space can be defined for the optimal scale by analyzing the factors that will affect the choice of scaling factor. Therefore s is defined as:</p><figure id="6d931524-fb69-4510-a18a-b160bc9bfc29" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>s</mi><mo lspace="0em" rspace="0em">∗</mo></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msubsup><mi>s</mi><mi mathvariant="bold">X</mi><mi>α</mi></msubsup></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
\begin{split}
s^{*} &amp;= s_{\mathbf{X}}^{\alpha}
 
\end{split}
\end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5em;vertical-align:-0.5em;"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7387em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">X</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5em;"><span></span></span></span></span></span></span></span></span></div></figure><p id="2ad5b05f-14fc-4d70-a272-d2b3e7fdc10e" class="">In equation 5, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mi mathvariant="bold">X</mi></msub></mrow><annotation encoding="application/x-tex">s_{\mathbf{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3303em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> is the magnitude of the activation, and <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span><span>﻿</span></span> is the single hyper-parameter to balance between the protection of salient and non-salient channels. The best <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span></span><span>﻿</span></span> can be found out by a fast grid search over the interval of [0,1] (0 means no scaling, 1 means aggressive scaling). </p><h1 id="93e70be3-7387-42f0-82c8-2f167bd677d4" class="">Academic Impact</h1><p id="41db3725-b5a5-4d96-b644-57a13570bdbc" class="">
</p><figure id="dff1a1d7-e36c-45fc-8fe8-42d5b8e85f63" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2010.png"><img style="width:682px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2010.png"/></a></figure><p id="31aeb680-c1fe-438a-b8c9-e4408f474165" class=""><strong>Figure 10 [2]: Effect of various scaling factors (s&gt;1) on perplexity (OPT-6.7B model, Wiki-2 data)</strong></p><p id="38d88a87-1cfc-4dc3-bde4-eb1ee21eba70" class="">As can be seen in Figure 10, the author tried different scaling factors and found out that by searching over the scaling factor for search space, that scaling factor value of 2 reduced perplexity the most, increasing it again to 4 again led to degradation of perplexity</p><figure id="e96de105-3923-4a98-b0bf-68a312b3f105" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2011.png"><img style="width:705px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2011.png"/></a></figure><p id="f40eea94-3266-4f21-86a1-4085f0e5787b" class=""><strong>Figure 11 [2]: AWQ improved (lowest perplexity) overall SOTA PTQ methods for different model sizes and INT3, INT4 low-bit precision</strong></p><p id="5310b387-dc91-4aae-b18d-d7f8e86c6a2a" class="">From Figure 11, both INT3 and INT4, the AWQ is performing the best in terms of the perplexity ( Llama-2, LLaMA ) in comparison to the previous state-of-the-art architecture (RTN and GPTQ [14]). </p><figure id="d321558c-2d54-4b26-b832-fe2cb470af3a" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2012.png"><img style="width:916px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2012.png"/></a></figure><p id="8822fb59-bdba-4830-ba5d-dafad3465765" class=""><strong>Figure 12[2]: (a): Quantization results of a visual language model OpenFlamingo-9B [15] on COCO Captioning datasets, (b): Qualitative results of quantized OpenFlamingo-9B [15] on COCO captioning dataset (4-shot, INT4-g128 quantization). </strong></p><p id="472b114e-d9d2-41fb-8faf-6df693d435f4" class="">
</p><p id="9b2be0ff-315e-4b98-8c91-ad1ff8c935bd" class="">From Figure 12 (a &amp; b), quantization and qualitative results are shown for OpenFlamingo-9B on COCO captioning datasets. AWQ outperforms existing methods under zero-shot and various few-shot settings, demonstrating the generability to different modalities and in-context learning workloads. It reduces the quantization degradation (32-shot) from 4.57 to 1.17 under INT4-g128, providing 4× model size reduction with negligible performance loss. Qualitatively (Figure 12 (b)), it can be seen that AWQ gave better captions. For image 12(b), two dogs walking on the street is given as a caption whereas W4-RTN gave the wrong caption (it talks about the bushes). </p><h3 id="cd9b2fe2-c01d-4190-a1af-083ce381e0d6" class=""><strong>Speedup Evaluation</strong></h3><figure id="266391be-786c-4572-b2ca-64bf06d148f6" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2013.png"><img style="width:833px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2013.png"/></a></figure><p id="081f9687-c8c1-4ef6-bf7e-a42f1d3cf05f" class=""><strong>Figure 13: AWQ speed comparison (in terms of tokens/sec) concerning FP16 model (from HuggingFace) on three different devices. AWQ offered up to 3.9x to 3.5x speed up. </strong></p><p id="c9afa5d8-4a65-4faf-80ac-a0462f7b0331" class="">
</p><p id="b89a6e5c-9a86-4ce0-880d-1685abb4ffbc" class="">The speedup was evaluated for AWQ on RTX 4090 (desktop GPU), RTX 4070 (laptop GPU), and Jetso Orin mobile GPU. For batch size = 1, the inference was performed for all LLMs using a fixed prompt length of 4 tokens. 200 tokens were generated for each inference run and the median latency was calculated. Figure 13, shows a 2.7-3.9x speedup to three families of LLMs (Llama-2, MPT, and Falcon) on 4090 compared with HuggingFace FP16 implementation. </p><h1 id="dc4b9e80-ab7a-4da4-b4eb-ce347d532efa" class="">Industrial and Social Impact</h1><figure id="73f9423f-90ab-42a3-9561-4c336e22dd6f"><div class="source"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/lec13_removed_(1).pdf">https://prod-files-secure.s3.us-west-2.amazonaws.com/779e1b8a-0e93-42b6-83b1-a403fb189ca5/08d97dc3-3fc4-46d6-b230-baebfd11772a/lec13_removed_(1).pdf</a></div></figure><p id="bcbd5911-1333-4269-a1ed-116ad9a2a110" class="">
</p><p id="e7ce3d8d-0b95-4789-8e1d-1053c96b6798" class="">AWQ has already been making an impact in the field of Deep Learning. Applications like vLLMs, FastChat, Imdeploy, and replicate have already integrated it with their mainframes (Links provided above). </p><h2 id="1dd0923b-6f9a-4b7b-9510-645a9816c8b1" class=""><strong>Industrial Impact</strong></h2><ol type="1" id="11c7d3e2-9d07-48a4-bd07-1199a14d2644" class="numbered-list" start="1"><li><strong>Hardware Efficiency:</strong> Quantization is crucial in optimizing hardware efficiency, especially in the development of electronic devices and integrated circuits. By representing data with fewer bits, the storage and transmission requirements are reduced, leading to more energy-efficient and cost-effective hardware solutions.</li></ol><ol type="1" id="13508de0-98df-4f52-93d8-f2f9df156aa3" class="numbered-list" start="2"><li><strong>Computational Performance:</strong> In industrial applications such as machine learning and signal processing, quantization plays a pivotal role in enhancing computational performance. By reducing the precision of numerical representations, algorithms can operate faster, making real-time processing feasible in various industries, including manufacturing, finance, and telecommunications.</li></ol><ol type="1" id="6f5797cb-ee92-40ed-a1c4-b71565467dec" class="numbered-list" start="3"><li><strong>Embedded Systems:</strong> Quantization is essential in the design of embedded systems, which are prevalent in industrial automation and control systems. These systems often operate under resource constraints, and efficient quantization techniques enable the implementation of complex algorithms on resource-limited devices, contributing to the advancement of Industry 4.0.</li></ol><ol type="1" id="ace22efd-1d04-4a27-bb8c-9dfc089d311a" class="numbered-list" start="4"><li><strong>Communication Systems:</strong> In telecommunications and networking, quantization is instrumental in compressing and transmitting data efficiently. This is particularly relevant for the efficient utilization of bandwidth, reducing latency, and ensuring reliable communication in industrial applications.</li></ol><h3 id="e724ac6a-4118-4371-9852-3a17976d1d0c" class="">Platforms with AWQ Integration</h3><ol type="1" id="76485b5f-2f8d-4443-8008-aea70e12fb0b" class="numbered-list" start="1"><li><a href="https://github.com/lm-sys/FastChat"> FastChat</a></li></ol><ol type="1" id="afd0dc01-1f5d-4be1-b339-4252becf27f0" class="numbered-list" start="2"><li><a href="https://github.com/replicate/vllm-with-loras/tree/main">Replicate</a> </li></ol><ol type="1" id="28f81431-d574-4b7e-882b-528b33d239ae" class="numbered-list" start="3"><li><a href="https://github.com/InternLM/"><strong>InternLM</strong></a></li></ol><ol type="1" id="6179eb72-ba07-4aa4-b17e-53dd28a35303" class="numbered-list" start="4"><li><a href="https://github.com/vllm-project/">vLLM</a></li></ol><h2 id="dc926b75-06ec-4a27-bad6-5e2e25d4a615" class=""><strong>Social Impact</strong></h2><ol type="1" id="7e45317e-3e17-47c8-859f-e1d94b4eb419" class="numbered-list" start="1"><li><strong>Data Storage and Transmission:</strong> Quantization has a direct impact on data storage and transmission in social contexts. In everyday life, this is evident in multimedia applications, where compressed images, videos, and audio files utilize quantization techniques to reduce file sizes without significant loss of perceived quality. This, in turn, contributes to faster and more efficient sharing of information on social media platforms.</li></ol><ol type="1" id="4ac4dfcc-e5c5-4a2e-bfb4-8f28e5d5acc3" class="numbered-list" start="2"><li><strong>Mobile and Wearable Devices:</strong> Quantization is crucial in the development of mobile and wearable technologies that have become integral parts of our daily lives. By employing quantization to optimize algorithms and reduce power consumption, these devices can offer longer battery life, making technology more accessible and convenient for a broader population.</li></ol><ol type="1" id="5b8500f7-e5ed-42ed-bb6a-668deb7e80b0" class="numbered-list" start="3"><li><strong>Healthcare:</strong> In medical imaging and diagnostics, quantization aids in the efficient storage and transmission of patient data. This is vital for the timely sharing of medical information among healthcare professionals and for the development of telemedicine solutions, improving access to healthcare services, especially in remote or underserved areas.</li></ol><ol type="1" id="57c02ab9-3762-4199-90b2-d0a60938b297" class="numbered-list" start="4"><li><strong>Privacy and Security:</strong> Quantization plays a role in ensuring privacy and security in social and communication systems. By reducing the amount of information transmitted and stored, quantization contributes to protecting sensitive data and maintaining user privacy in various online and digital interactions.</li></ol><p id="15a5875b-e895-47a3-902a-105cda58103c" class="">In summary, quantization&#x27;s industrial and social impact is broad, ranging from optimizing hardware and computational efficiency to facilitating faster and more efficient data storage, transmission, and communication across various sectors of society.</p><h1 id="c5119936-9ab0-4e66-9d4c-211341302550" class="">Review</h1><h2 id="d326a8d0-e810-4ac8-b7f9-ed56600c7bc1" class=""><strong>Rakesh Rathod (score - 7/10, Accept)</strong></h2><p id="22ac0ddc-fe6e-49d9-be19-8cf821cd8ace" class="">I find the paper&#x27;s innovative approach, introducing Activation-aware Weight Quantization (AWQ), to be a significant strength. AWQ provides a fresh perspective on addressing low-bit weight-only quantization challenges for Large Language Models (LLMs). The experimental results robustly support AWQ&#x27;s effectiveness, consistently outperforming existing methods like round-to-nearest quantization (RTN) and GPTQ across a diverse range of LLM models. This innovation positions AWQ as a promising solution for enhancing the efficiency of language models.</p><p id="023994ab-11df-45b0-945c-1ae2d03facf8" class="">However, a notable weakness is the paper&#x27;s limited details on the implementation of AWQ. While it emphasizes the efficiency of the system implementation, the lack of specific technical details about optimizations and considerations during implementation raises questions about reproducibility and robustness. A more thorough exposition on the implementation would strengthen the paper&#x27;s practical foundation.</p><h2 id="69457025-2d73-4592-b4ac-b2473395914f" class=""><strong>Luv Verma (score - 7/10, Accept) </strong></h2><p id="9ff8ddb3-dfae-45b3-be0b-1eee038dd3b6" class="">While the paper exhibits strengths, there are areas that warrant attention and improvement. One such strength is the inclusion of a practical system implementation alongside theoretical advancements. This feature sets AWQ apart by translating the achieved memory savings into substantial speedups, making it a practical solution for deployment on different GPUs. The widespread adoption of AWQ by various open-source LLM serving solutions further validates its utility within the research community.</p><p id="4e634793-281f-4711-b823-122073374cbc" class="">However, a corresponding weakness lies in the assumption made in the paper regarding the relationship between activation magnitude and weight channel saliency. While this assumption is foundational to AWQ, the paper lacks sufficient explanation or evidence to justify this choice. A more comprehensive exploration of this aspect would bolster the paper&#x27;s theoretical underpinnings and strengthen its overall argument. Also, the method is evaluated on standard accuracy metrics such as perplexity and accuracy, however besides accuracy there are other important LLM benchmarks like robustness, fairness, bias, toxicity, helpfulness where there are no evaluated results</p><h1 id="8802dffb-9543-418d-a92c-6381a8be985e" class="">Demo</h1><p id="4a55c7ea-5604-4e59-87c9-8840b1ae73a0" class="">Files are available at - <a href="https://huggingface.co/spaces/rakesh9177/Quantization/tree/main">HuggingFace</a></p><p id="0ac58879-c58b-4e17-ad75-aad47a6f18a1" class="">Demo on perplexity over 1.3b parameter model</p><figure id="e9cf0804-1ccd-4bc1-8517-0aae518a519b"><div class="source"><a href="https://rakesh9177-quantization.hf.space">https://rakesh9177-quantization.hf.space</a></div></figure><p id="180b3a58-ef9f-42ca-a525-f0a253a33d72" class="">Example of Llama2 performance non-quantized vs quantized:</p><figure id="01a69708-d40f-4725-878a-46d16f446cfe" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/4090_example.gif"><img style="width:2940px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/4090_example.gif"/></a></figure><h1 id="19db4927-e650-44dd-b319-3cf0d1733ab9" class="">References</h1><p id="749cc5c8-3441-4ac9-980d-bd813b3b7bdf" class="">
</p><p id="359ddddf-582c-4526-b900-fcb61f2522af" class="">[1] Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.</p><p id="ec819259-2819-46da-ad39-1539820355d7" class="">[2] Lin, J., Tang, J., Tang, H., Yang, S., Dang, X., &amp; Han, S. (2023). AWQ: Activation-aware Weight Quantization for LLM Compression and Acceleration. <em>arXiv preprint arXiv:2306.00978</em>.</p><p id="f1697b84-d13d-411f-a2cb-fdf8332e76c6" class="">[3] Han, Song, Huizi Mao, and William J. Dally. &quot;Deep compression: Compressing deep neural networks with pruning, trained quantization and huffman coding.&quot; <em>arXiv preprint arXiv:1510.00149</em> (2015).</p><p id="9f8e2ba8-ebab-4c12-87c4-a7e3ee68647e" class="">[4] <a href="https://pytorch.org/docs/stable/quantization.html">https://pytorch.org/docs/stable/quantization.html</a></p><p id="00c784c4-e7b0-4f31-9e60-ede97fb303fc" class="">[5] Migacz, Szymon. &quot;8-bit inference with tensorrt.&quot; <em>GPU technology conference</em>. Vol. 2. No. 4. 2017.</p><p id="60a13258-b920-4342-b724-053c3f55487c" class="">[6] Krishnamoorthi, Raghuraman. &quot;Quantizing deep convolutional networks for efficient inference: A whitepaper.&quot; <em>arXiv preprint arXiv:1806.08342</em> (2018).</p><p id="a2a9bde7-f1e8-407c-ba24-3fb464075eb8" class="">[7] Frantar, Elias, et al. &quot;Gptq: Accurate post-training quantization for generative pre-trained transformers.&quot; <em>arXiv preprint arXiv:2210.17323</em> (2022).</p><p id="af46ea46-11d8-4dd9-a4cc-92ba6ed82681" class="">[8] Dettmers, Tim, and Luke Zettlemoyer. &quot;The case for 4-bit precision: k-bit inference scaling laws.&quot; <em>International Conference on Machine Learning</em>. PMLR, 2023.</p><p id="df9295d9-3f9d-4755-8bd7-5751094ef480" class="">[9] Dettmers, Tim, et al. &quot;Llm. int8 (): 8-bit matrix multiplication for transformers at scale.&quot; <em>arXiv preprint arXiv:2208.07339</em> (2022).</p><p id="20503ce9-ac37-4ff0-b0b5-1465e8167691" class="">[10] Han, Song, et al. &quot;Learning both weights and connections for efficient neural network.&quot; <em>Advances in neural information processing systems</em> 28 (2015).</p><p id="f22d329b-7e37-425a-b226-fcfea7acc9bb" class="">[11] Xiao, Guangxuan, et al. &quot;Smoothquant: Accurate and efficient post-training quantization for large language models.&quot; <em>International Conference on Machine Learning</em>. PMLR, 2023.</p><p id="3908769e-9fce-45e0-b208-8044c3bab342" class="">[12] Sheng, Ying, et al. &quot;High-throughput generative inference of large language models with a single gpu.&quot; <em>arXiv preprint arXiv:2303.06865</em> (2023).</p><p id="0fca8bc7-a4ee-4640-b090-370b0a585976" class="">[13] Xiao, G., Lin, J., Seznec, M., Wu, H., Demouth, J., &amp; Han, S. (2023, July). Smoothquant: Accurate and efficient post-training quantization for large language models. In <em>International Conference on Machine Learning</em> (pp. 38087-38099). PMLR.</p><p id="d503c74b-a513-4151-bd3b-d449109dc5da" class="">[14] Elias Frantar, Saleh Ashkboos, Torsten Hoefler, and Dan Alistarh. Gptq: Accurate post-training quantization for generative pre-trained transformers. arXiv preprint arXiv:2210.17323, 2022.</p><p id="98df9c1f-6ec6-4f68-ad70-c79874d1bf88" class="">[15] Anas Awadalla, Irena Gao, Joshua Gardner, Jack Hessel, Yusuf Hanafy, Wanrong Zhu, Kalyani Marathe, Yonatan Bitton, Samir Gadre, Jenia Jitsev, Simon Kornblith, Pang Wei Koh, Gabriel Ilharco, Mitchell Wortsman, and Ludwig Schmidt. Openflamingo, March 2023.</p><p id="6c8565a6-4f89-4f1d-a9ca-1bee0b39a242" class="">[16] Roofline: An Insightful Visual Performance Model for Multicore Architectures</p><p id="fd85389d-0964-4879-becb-92c410467bcc" class="">[17] Jacob, Benoit, Skirmantas Kligys, Bo Chen, Menglong Zhu, Matthew Tang, Andrew Howard, Hartwig Adam, and Dmitry Kalenichenko. &quot;Quantization and training of neural networks for efficient integer-arithmetic-only inference.&quot; In <em>Proceedings of the IEEE conference on computer vision and pattern recognition</em>, pp. 2704-2713. 2018.</p><h1 id="b830616c-acc6-4706-ae88-31b019dc98c5" class="">Appendix</h1><h2 id="958c2800-a7dd-40b7-b4dc-326b35ef1031" class="">Basics of Quantization</h2><ol type="1" id="6ae401d1-5d22-4764-bcd0-0c766b9281b2" class="numbered-list" start="1"><li><strong>Quantization:</strong> It is the process of constraining an input from a continuous or otherwise large set of values to a discrete set (Figure 1)</li></ol><figure id="964e11a4-0acf-4830-bf35-69faaa140d97" class="image"><a href="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2014.png"><img style="width:837px" src="An%20Analysis%20of%20AWQ%20Activation-aware%20Weight%20Quantiz%20eb968c294c3d44758f721eb450ad8ebd/Untitled%2014.png"/></a></figure><p id="be8977ba-b6fe-4533-8e09-9011be1a73e6" class=""><strong>Figure 1: Quantized signal and Image</strong></p><ol type="1" id="39524995-087e-479c-8653-17c274705881" class="numbered-list" start="2"><li><strong>Numerical Formats (Table 1 )</strong>: BF16 is very popular among the LLM community for standard pretraining. BF16 is known for helping in training stability (supported by a100 NVIDIA GPU). For inference, the models are either quantized in INT8, INT4 or INT3. INT8 has a range from -128 to 127.</li></ol><p id="8f2fe260-46ad-4fa0-9c55-202531eaadac" class=""><strong>Table 1: Details of various commonly used numerical formats ( 1 bit is assigned to sign)</strong></p><table id="f03bab60-b740-4fc7-b84e-f9fbd0fd9773" class="simple-table"><tbody><tr id="3b308710-26c9-49fe-bcca-99303562ecd1"><td id=":ZwK" class=""></td><td id="o{Kt" class=""><strong>Bits</strong></td><td id="QzKE" class=""><strong>Exponent</strong></td><td id="YQKl" class=""><strong>Fraction</strong> </td><td id="s@BF" class=""><strong>Memory to store one value</strong></td></tr><tr id="297e76a4-2f11-4307-887f-5e0bb5ee8ffb"><td id=":ZwK" class=""><strong>FP32</strong></td><td id="o{Kt" class="">32</td><td id="QzKE" class="">8</td><td id="YQKl" class="">23</td><td id="s@BF" class="">4 bytes</td></tr><tr id="18a4548f-d254-490a-895b-8086e98fde69"><td id=":ZwK" class=""><strong>FP16</strong></td><td id="o{Kt" class="">16</td><td id="QzKE" class="">5</td><td id="YQKl" class="">10</td><td id="s@BF" class="">2 bytes</td></tr><tr id="5870b24f-b378-473e-a777-c50d3de4db78"><td id=":ZwK" class=""><strong>BFLOAT16</strong></td><td id="o{Kt" class="">16</td><td id="QzKE" class="">8</td><td id="YQKl" class="">7</td><td id="s@BF" class="">2 bytes</td></tr><tr id="a732fcf9-e1ac-4063-9990-998b036d0308"><td id=":ZwK" class=""><strong>INT8</strong></td><td id="o{Kt" class="">8</td><td id="QzKE" class="">-/-</td><td id="YQKl" class="">7</td><td id="s@BF" class="">1 byte</td></tr></tbody></table><ol type="1" id="721214cf-2118-450c-9783-f685a15b7107" class="numbered-list" start="3"><li><strong>Bytes required per parameter:</strong> Table 2 shows the bytes required per parameter during training for 1 billion parameters.</li></ol><table id="1fc2e34b-1883-47b2-84d9-053fe21e3334" class="simple-table"><tbody><tr id="8477b00c-bf72-4ac8-a246-f4ab62802905"><td id="ALYe" class="" style="width:349px"></td><td id="|P{:" class="" style="width:349px"><strong>Bytes per parameter</strong></td></tr><tr id="648a7674-651f-424a-9e4c-5f426b64c532"><td id="ALYe" class="" style="width:349px"><strong>Model parameters (Weights)</strong></td><td id="|P{:" class="" style="width:349px">4 </td></tr><tr id="fa190b3a-108a-4586-a390-4d3a9e712913"><td id="ALYe" class="" style="width:349px"><strong>Adam Optimizer (2 states)</strong></td><td id="|P{:" class="" style="width:349px">8</td></tr><tr id="bd51bb68-85a7-4eea-8cc2-aa1f1907432f"><td id="ALYe" class="" style="width:349px"><strong>Gradients</strong></td><td id="|P{:" class="" style="width:349px">4</td></tr><tr id="6326291d-7f0d-46a0-b404-16174ddd408a"><td id="ALYe" class="" style="width:349px"><strong>Activations and temp Memory (Variable Size)</strong></td><td id="|P{:" class="" style="width:349px">8</td></tr><tr id="08e80d6b-4ba7-4d71-b778-8412e218cbc2"><td id="ALYe" class="" style="width:349px"><strong>Total memory per parameter</strong></td><td id="|P{:" class="" style="width:349px">4 bytes + 20 bytes (per parameter)</td></tr><tr id="dd18f3a0-e3e3-4114-a763-5cc23fe7f519"><td id="ALYe" class="" style="width:349px"><strong>Memory for 1 billion parameters at FP32</strong></td><td id="|P{:" class="" style="width:349px">24 bytes * 1 bil = 24 GB</td></tr></tbody></table><ol type="1" id="5d77d345-606b-43ab-a823-dfd142801dfd" class="numbered-list" start="4"><li><strong>Two Complement’s Representation:</strong> The most commonly used numeric data type.<ul id="96694876-6ae0-4f7e-b75e-7e1cecb3b971" class="bulleted-list"><li style="list-style-type:disc">n-bit Range: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo separator="true">,</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-2^{n-1}, 2^{n-1}-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span><span>﻿</span></span></li></ul><ul id="2072a363-c3ca-468f-83b6-bbb0310e3ac4" class="bulleted-list"><li style="list-style-type:disc">000…00 represents 0</li></ul><ul id="b9fbf6f2-1b3d-41d1-a738-4f15a902ae1e" class="bulleted-list"><li style="list-style-type:disc">100…00 represents <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">-2^{n-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span></li></ul><ul id="6cd55fa3-9201-47a0-acd2-10da02d9e1ed" class="bulleted-list"><li style="list-style-type:disc">Generally used to convert either FP32, FP16, or BF16 representation to binary or vice-versa.</li></ul></li></ol><ol type="1" id="86e516c4-8494-4bba-b821-7ab0e4e1702f" class="numbered-list" start="5"><li><strong>The common choice for quantization in DL networks</strong>: Weights and activations. Quantizing weights leads to a reduction in storage/memory requirements. Methods like linear quantization can also lead to lesser computational costs with the help of integer arithmetic during forward and backward propagation (quantization aware training [17])</li></ol><p id="c319e86c-b08c-4704-9fac-d4b939b30736" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>